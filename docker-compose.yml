version: '3.8'
services:
  backend:
    build: .
    container_name: rbotzilla_backend
    environment:
      - RICK_ENV=practice
    ports:
      - "8000:8000"
    volumes:
      - ./:/app
    command: ["/bin/sh", "-c", "PYTHONPATH=/app python backend.py"]
version: '3.7'
services:
  oanda_engine:
    build: .
    container_name: rick_oanda_engine
    restart: always
    volumes:
      - ./narration.jsonl:/app/narration.jsonl
      - ./logs/oanda:/app/logs
    environment:
      - ENV=practice
      - PLATFORM=oanda
    command: bash start_with_integrity.sh

  coinbase_engine:
    build: .
    container_name: rick_coinbase_engine
    restart: always
    volumes:
      - ./narration.jsonl:/app/narration.jsonl
      - ./logs/coinbase:/app/logs
    environment:
      - ENV=canary
      - PLATFORM=coinbase
    command: bash start_with_integrity.sh

  ibkr_engine:
    build: .
    container_name: rick_ibkr_engine
    restart: always
    volumes:
      - ./narration.jsonl:/app/narration.jsonl
      - ./logs/ibkr:/app/logs
    environment:
      - ENV=paper
      - PLATFORM=ibkr
    command: bash start_with_integrity.sh
